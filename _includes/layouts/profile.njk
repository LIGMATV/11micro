<!DOCTYPE html>
<html lang="{{ getData.lang }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ getData.title }}</title>
    <meta name="description" content="{{ getData.bio }}">
    <meta name="generator" content="Eleventy v3.0.0">
    <link rel="shortcut icon" href="{{ getData.favicon }}">
    {% if getData.mastodon %}
    <script src="/modules/mastodon-timeline.umd.js"></script>
    <link rel="stylesheet" href="/modules/mastodon-timeline.min.css">
    {% endif %}
    {% if getData.bluesky %}
    <script src="/modules/bsky-embed.umd.js"></script>
    {% endif %}
    <style>
:root {
    --primary: {{ getData.primary }};
    --secondary: {{ getData.secondary }};
} 

{% include "css/style.css" %}
    </style>
</head>

<body data-profile="{{ data }}">
    <main>
        <section class="header">
            <img src="{{ getData.favicon }}" alt="Favicon" class="favicon" width="128" height="128">
            <h1 class="title">{{ getData.title }}</h1>
            <div id="pronouns" class="pronouns" title="Prononus: {{ getData.pronouns }}">{{ getData.pronouns }}</div>
            <div id="badges" class="badges">
                <ul>
                    {% for key, badge in getData.badges %}
                    <li>
                        <a href="{{ badge.url }}" id="badge-{{ key }}">
                            <img src="{{ badge.img }}" alt="{{ badge.title }}" title="{{ badge.title }}" height="18">
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>            
            <div id="social" class="header-social">
                <ul>
                    {% for key, data in getData.items.social %}
                    {% if key != "title" %}
                    <li>
                        <a rel="me" href="{{ data.url }}">
                            {% if not data.customIcon %}
                                <span class="si-icon" title="{{ key | capitalize }}">{% icon "si:" + key %}</span>
                            {% endif %}
                            {% if data.customIcon %}
                                <span class="custom-icon" title="{{ key | capitalize }}">{{ data.customIcon | markdownifyInline | safe }}</span>
                            {% endif %}
                        </a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
            <div id="bio" class="bio">{{ getData.bio }}</div>
        </section>

        {% if getData.notes %}
        <section class="notes" id="notes">
            {% for key, note in getData.notes %}
            <details id="note-{{ key }}" open>
                <summary>
                    <a href="#note-{{ key }}" class="anchor">#</a>
                    <h2>{{ note.title }}</h2>
                </summary>
                <article>
                    {{ note.content | markdownify | safe }}
                </article>
            </details>
            {% endfor %}
        </section>
        {% endif %}

        {% if getData.items %}
        <section class="items" id="items">
            {% for category, links in getData.items %}
            <details id="items-{{ category }}" open>
                <summary>
                    <a href="#items-{{ category }}" class="anchor">#</a>
                    <h2>{{ links.title }}</h2>
                </summary>
                <ul>
                    {% for key, data in links %}
                    {% if key != "title" %}
                    <li>
                        <a rel="me" id="items-{{ category }}-{{ key }}" href="{{ data.url }}">
                            {% if not data.customIcon %}
                                <span class="si-icon" title="{{ key | capitalize }}">{% icon "si:" + key %}</span>
                            {% endif %}
                            {% if data.customIcon %}
                                <span class="custom-icon" title="{{ key | capitalize }}">{{ data.customIcon | markdownifyInline | safe }}</span>
                            {% endif %}
                            <span class="link">{{ data.title }}</span>
                        </a>                        
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </details>
            {% endfor %}
        </section>
        {% endif %}

        {% if getData.featured %}
        <section class="featured" id="featured">
            {% for category, items in getData.featured %}
            <details id="featured-{{ category }}" open>
                <summary>
                    <a href="#featured-{{ category }}" class="anchor">#</a>
                    <h2>{{ items.title }}</h2>
                </summary>
                <ul>
                    {% for key, project in items %}
                    {% if key != "title" %}
                    <li>
                        <a href="{{ project.url }}" id="featured-{{ category }}-{{ key }}">
                            <div class="featured-item">
                                <img src="{{ project.cover }}" alt="{{ project.title }}">
                                <div class="info">
                                    <h3>{{ project.title }}</h3>
                                    <p>{{ project.summary }}</p>
                                </div>
                            </div>
                        </a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </details>
            {% endfor %}
        </section>
        {% endif %}

        {% if getData.mastodon %}
        <section class="feed" id="mastodon-feed">
            <details open>
                <summary>
                    <a href="#mastodon-feed" class="anchor">#</a>
                    <h2> {% icon "si:mastodon" %} Mastodon Feed</h2>
                    <a class="btn" href="{{ getData.mastodon.instance }}/@{{ getData.mastodon.username }}">Open</a>
                </summary>
                <div id="mt-container" class="mt-container">
                    <div class="mt-body" role="feed">
                        <div class="mt-loading-spinner"></div>
                    </div>
                </div>  
            </details>            
        </section>
        {% endif %}

        {% if getData.bluesky %}
        <section class="feed" id="bsky-feed">
            <details open>
                <summary>
                    <a href="#bsky-feed" class="anchor">#</a>
                    <h2> {% icon "si:bluesky" %} Bluesky Feed</h2>
                    <a class="btn" href="https://bsky.app/profile/{{ getData.bluesky.username }}">Open</a>
                </summary>
                <bsky-embed
                    username="{{ getData.bluesky.username }}"
                    limit="20"
                    load-more="true"
                    custom-styles="section { max-height: calc(100vh + 4rem); overflow-y: auto; overflow-x: hidden; }">
                </bsky-embed>
            </details>
        </section>   
        {% endif %}

    </main>

    <footer>
        <span>Powered by <a href="https://github.com/LIGMATV/11micro">11micro</a> (<a href="https://www.11ty.dev/docs/">11ty</a>).</span>
        {% if getData.repo %}
        <span><a href="{{ getData.repo }}/blob/main/_data/{{ data }}.yaml">Data source</a></span>
        {% endif %}
    </footer>

    {% if getData.mastodon %}
    <script>
        const myTimeline = new MastodonTimeline.Init({
            instanceUrl: "{{ getData.mastodon.instance }}",
            timelineType: "profile",
            userId: "{{ getData.mastodon.id }}",
            profileName: "@{{ getData.mastodon.username }}"
        });
    </script>
    {% endif %}

</body>

</html>